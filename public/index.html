<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>NATaSSHka</title>
    <link rel="stylesheet" href="css/layout.css">
</head>
<body>
    <div class="app-container">
        <!-- Сайдбар -->
        <div class="sidebar">
            <div class="sidebar-header">
                <button id="hideSidebarBtn" class="sidebar-toggle-btn hidden">
                    <img src="icons/circle-arrow-left.svg" alt="File icon" class="file-icon" draggable="false">
                </button>
                <div class="room-info" id="roomInfo"></div>
                <div class="user-info" id="userInfo"></div>
            </div>
            <div class="users-list" id="usersList"></div>
        </div>
        
        <!-- Основной чат -->
        <div class="chat-container">
            <div class="chat-header">
                <div class="header-content">
                    <button id="showSidebarBtn" class="sidebar-toggle-btn hidden">
                        <img src="icons/circle-arrow-right.svg" alt="File icon" class="file-icon" draggable="false">
                    </button>
                    
                    <div class="encryption-input-wrapper">
                        <input type="password" id="encryptionKeyInput" placeholder="Ключ шифрования" class="encryption-input-header">
                        <button id="clearEncryptionKey" class="clear-key-btn">×</button>
                    </div>
                    
                    <div class="call-buttons-container">
                        <button id="audioCallBtn" class="call-btn">
                            <img src="icons/call.svg" alt="File icon" class="file-icon" draggable="false">
                        </button>
                        <button id="videoCallBtn" class="call-btn">
                            <img src="icons/camera-5.svg" alt="File icon" class="file-icon" draggable="false">
                        </button>
                    </div>
                </div>
            </div>
            <div class="messages-container" id="messagesContainer"></div>
            <div class="message-input-container">
                <input type="text" id="messageInput" placeholder="Введите сообщение...">
                <div class="record-buttons-container">
                    <button id="recordButton" class="record-btn" style="background-image: url('icons/mic.svg'); background-color: white; background-repeat: no-repeat; background-position: center; background-size: contain; -webkit-touch-callout: none; -webkit-user-select: none; user-select: none; -webkit-tap-highlight-color: transparent;">
                    </button>
                    <button id="recordVideoBtn" class="record-btn" style="background-image: url('icons/video.svg'); background-color: white; background-repeat: no-repeat; background-position: center; background-size: contain; -webkit-touch-callout: none; -webkit-user-select: none; user-select: none; -webkit-tap-highlight-color: transparent;">
                    </button>
                </div>
                <div class="send-file-container">
                    <label for="fileInput" class="file-input-label">
                        <img src="icons/clip.svg" alt="File icon" class="file-icon" draggable="false">
                    </label>
                    <button id="sendMessageBtn">↵</button>
                </div>
                <input type="file" id="fileInput" hidden>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно входа -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>Вход в чат</h2>
            <input type="text" id="usernameInput" placeholder="Имя пользователя" 
                   pattern="[a-zA-Z0-9_-]{1,64}" 
                   title="Только латинские буквы, цифры, дефис и нижнее подчеркивание (макс. 64 символа)">
            <input type="text" id="roomInput" placeholder="Название комнаты" value="Room_01"
                   pattern="[a-zA-Z0-9_-]{1,64}"
                   title="Только латинские буквы, цифры, дефис и нижнее подчеркивание (макс. 64 символа)">
            <input type="password" id="passwordInput" placeholder="Пароль">
            <button id="joinChatBtn">Войти</button>
            <div class="error-message" id="loginError"></div>
        </div>
    </div>
    
    <!-- Индикатор записи аудио -->
    <div class="recording-indicator hidden" id="recordingIndicator">
        <div class="recording-dot"></div>
        Запись аудио...
    </div>
    
    <!-- Индикатор записи видео -->
    <div class="recording-indicator hidden" id="videoRecordingIndicator">
        <div class="recording-dot"></div>
        Запись...
    </div>
    
    <!-- Модальное окно предпросмотра камеры -->
    <div class="modal hidden" id="cameraPreviewModal">
        <video id="cameraPreview" autoplay muted></video>
        <div class="recording-timer">0.0 сек</div>
    </div>
    
    <!-- Модальное окно подготовки устройства -->
    <div class="modal hidden" id="preparingModal">
        <div class="modal-content">
            <h2>Подготовка устройства для записи. Ждите...</h2>
        </div>
    </div>
    
    <!-- Модальное окно сообщений -->
    <div class="modal hidden" id="messageModal">
        <div class="modal-content">
            <h2 id="messageModalTitle">Сообщение</h2>
            <p id="messageModalText"></p>
            <button id="messageModalOkBtn" class="modal-ok-btn">OK</button>
        </div>
    </div>
    
   <!-- Модальное окно для изображений -->
<div class="image-modal" id="imageModal">
    <div class="image-modal-overlay"></div>
    <div class="image-modal-content">
        <button class="image-close-btn">×</button>
        <img id="modalImage" src="" alt="Увеличенное изображение">
    </div>
</div>
    
 <!-- Модальное окно для видео -->
<div class="video-modal" id="videoModal">
    <div class="video-modal-overlay"></div>
    <div class="video-modal-content">
        <button class="video-close-btn">×</button>
        <video id="modalVideo" controls>
            Ваш браузер не поддерживает видео.
        </video>
    </div>
</div>
    <!-- Скрипты -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <!--<script src="js/crypto-js.min.js"></script> -->
    <script src="js/crypto.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="js/cookie.js"></script>
    <script src="js/mediaDevices.js"></script>
    <script src="js/audioRecorder.js"></script>
    <script src="js/videoRecorder.js"></script>
    <script src="js/webrtc.js"></script>
    <script src="js/client.js"></script>
    <script src="js/reactions.js"></script>
    <script src="js/messageInputAnimations.js"></script>
</body>
</html>